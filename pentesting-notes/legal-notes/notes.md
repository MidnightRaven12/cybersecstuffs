So you want to go and bring a system to its knees. Let's talk about ways to do it legally, and what you need to know before you get the FBI on your back. (Here are some links that we got this from: [security current](https://securitycurrent.com/legal-issues-in-penetration-testing/).)

1. **RoE** (Rules of Engagement) These are basically rules dictating a few things, such as, when engagements are going to happen (think of business hours vs. off hours when DDOS attacks can happen), the objectives (are you [stress testing](https://en.wikipedia.org/wiki/Stress_testing) a network, or are you trying to **assess** out how possible it is to move laterally through a network?), who to call, which are known as **P**oints **O**f **C**ontact (POC's can be the Chief Information Officer of a company or other Red Team Leads.) These also include what to do with **P**ersonally **I**dentifiable **I**nformation (**PII**, like SSNs of Employees found in a random database), what methodologies they are going to use, and what to do whenever something goes wrong, and who to contact.

These are also going to determine what types of test that you are going to do. For instance, is it a [white-box](https://en.wikipedia.org/wiki/White-box_testing) or [black box engagement?](https://en.wikipedia.org/wiki/Black-box_testing) Is there going to be a specific subnet set up for the Red Team / Pentesters to do their work? When will they expect downtime? Who is permitted to engage the pentest team? What behaviors will they expect?
   
2. **Scope**, which basically tells you what you can attack, and which systems they are going to be testing. This is especially important, as there are going to be several instances where there are machines that are either client machines (say, you're a cloud service provider, and you need to run a penetration test) , that are either too critical to run any tests on (like a health records database), or either too fragile to run any tests on (say a Windows 98 server that might crash when running an `nmap` scan on it.), In many cases, all three. Many hospital/banking/government systems are run on old operating systems and need strict review before updating (because updating might cause problems with already existing software, which has massive consequences on business). Additionally, because hospitals are heavily networked, and it has a lots of moving parts, it becomes a huge financial/time/staff burden for them to update everything to the latest versions. And then test all of them. And then respond to day to day IT stuff. (Most worryingly, lots of hospitals have simple passwords that are found in [`rockyou.txt`](https://github.com/zacheller/rockyou), and even default passwords on their routers and systems...*(1)*) Even some banking systems are still run on this old programming language called [COBOL](https://en.wikipedia.org/wiki/COBOL), which was made in the 1960s. 

*Remark: The current state of IT and information security is horrible. The idea that hospitals, government organizations, law enforcement, banking, etc. are bastions of safety is a myth. The problem is that many people at the top are (unsurprisingly) very corrupt, and tend to keep money for themselves (instead of trying to logically spend it on their business). Unfortunately, many people in upper management tend to take IT for granted (think: an ounce of prevention is worth a pound of cure), and then proceed to get shocked when they get hacked. But don't worry. Their profits are still the same, and all of this 11 million dollars needs to go to our people's mental health. And studies show that getting a new mansion really, helps with that. So. You know. I kinda need that 11 million dollars... Pretty please with a cherry on top?*

3. **NDA** (Non-Disclosure Agreement) These are basically the actions that you can take with information that you found at the company. For instance, there is going to be information about trade secrets (like a new product, or the inner workings of a business), and the NDA will deal with that accordingly. They will most likely talk about how long the information stays confidential, and how you can disclose the information.

4. **SLA** (Service Level Agreements) These are going to deal with how effective this penetration test is. For instance, after two years, many services will be updated (or not be updated), and many more machines might be hardened (or have an expanded attack surface.) Additionally, these will tell you how reliable the information it is in making other decisions. Say that you implement a white box test, and the CIO, is trying to draw conclusions on how likely an adversary is going to break in starting from a black box test. Well, yeah. It's gonna be harder (or maybe easier, because you may falsely think that some system is secure, when in fact it is not). Some other considerations to take note is the amount of resources dedicated to the test. (think one person who is trying to make sure the regulations are being upheld, versus an entire nation trying to hack your specific company for financial gain. See: [APT 38](https://web.archive.org/web/20230325143301/https://content.fireeye.com/apt/rpt-apt38)) Additionally, you may need to understand third part SLAs, (like what an Endpoint Detection Response is capable of).

5. **SOW** (Statement of Work) These are going to be dealing with the work that is being delivered, including how and when things are going to be done, and what tests are going to be run, and what deliverables are going to be created. This will also include the price of the work, and more terms and conditions.

6. **MSA** (Master Service Agreement) These are going to be common terms that a company will set up with a penetration testing group (or sometimes, just one person) for repeat business. For instance, in the **MSA**, there may be a clause stating that you cannot use any Denial of Service attacks, or that you cannot disclose any information about the penetration test and what you have found until after three years in any form, and that you cannot disclose **PII** ever. This makes statements of work much easier to go by, (since you can literally reference stuff in the Master Service Agreement)

7. **Non Compete Agreements** Lastly, you may also notice that there are some non-compete clauses if you end up taking a job in a penetration testing company. Usually, they will set a time frame in which you cannot apply to a competitor. These are there in order to not give competitors an advantage when they hire you after you move from one job to the next. But sometimes, they are used to limit employment choices for staff members. *(2)* 

*Remark 2: Yeah, this is also a reminder to* **LOOK AT YOUR CONTRACTS*** especially when it comes to things to employment, unions, and many more. You deserve rights, and [failure to upload these rights for yourself is the same as failing to uphold those rights for humanity](https://plato.stanford.edu/entries/kant-moral/#HumFor) (this is one aspect of Kant we agree with, but Kantian ethics do not necessarily reflect our own etnical views.) *
  
8. **Get out of Jail Free Cards**  (yes, these are real things, and not just a concept in Monopoly) These are exactly what they sound like. Literal cards (well, more likely laminated sheets of paper, but still, cards) in which you show to other people that you are there for a reason, and that you are not trying to break into the company. These are especially important, because when you mess up, and take down a production server, you don't want to be investigated by the FBI and then get arrested, and have to spend thousands of dollars, and many days in jail trying to defend yourself from a company. Then, something like [this](https://www.youtube.com/watch?v=bUk8PzfwpZg) will happen.

These are usually signed by a company, as well as **POC**'s, as well. There is a format that can be found [here](https://www.counterhack.net/permission_memo.html). 

9. **Venue and Jurisdiction** Yeah, there are even different laws based around the nature of hacking, as well as which tools that you can use. Let's say that a company is based in six different countries. Which country's laws do you use in order to determine the legal implications? And even in the United States, which state's laws are you going to use when determining the legal implications of your work? What tools are you even allowed to use? (yes, there are certain instances, in which some tools are banned, period, even for penetration testing.  See: [the absolute mess](https://www.theregister.com/2009/06/07/germany_hacker_tool_law/) that the German penal code implemented in 2007. In particular, intent does not matter, and only the purpose of the tools mattered.) **Venue** is where the legal action is going to take place, and **jurisdiction** is the authority of the law over an area.

There are even restrictions as to what tools you can export. Even encryption tools are subject to these types of restrictions. The United States prohibits you from exporting some hardware and software to places such as Cuba, North Korea, Iran, and Syria, and are under strict export control so it is important to check the local laws, and always consult with a lawyer if needed. *(3)*

*Remark 3: It is almost impossible to parse the actual document needed. This is [Chapter VII Part 740 Supplement No 1.](https://www.ecfr.gov/current/title-15/subtitle-B/chapter-VII/subchapter-C/part-740/appendix-Supplement%20No.%201%20to%20Part%20740), and the main gist is that A:1 are NATO countries with almost no restrictions on trade, and E:1 is are terrorist supporting countries, with sanctions on them. With B, C, and D issued in a similar fashion. So, this also prevents the exportation of some tools to other countries.* 

10. **Ownership** Say you make a piece of code, to use against a company. Say you write up the report of the penetration test. Who owns the report, and who owns the piece of code? Some might argue that you technically own the report, and some might argue that they own the piece of code that you used. Therefore, it becomes necessary to figure out ownership, and who owns what after the engagement.

See also: [the read team guide](https://redteam.guide/docs/Concepts/red-vs-pen-vs-vuln).
